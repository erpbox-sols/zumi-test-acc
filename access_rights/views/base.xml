<?xml version='1.0' encoding='utf-8'?>
<odoo>
    <!-- product.template inherit form view -->
    <record id="product_template_form_view_id_extended" model="ir.ui.view">
        <field name="name">product.template.form.inherit.view.extended</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_form_view"/>
        <field name="arch" type="xml">
            <xpath expr="//notebook/page[@name='general_information']/group[1]/group[@name='group_general']/field[@name='active']" position="after">
                <field name='allowed_modify_sale_price' invisible='1'/>
            </xpath>
            <xpath expr="//notebook/page[@name='general_information']/group[1]/group[@name='group_standard_price']/div[@name='pricing']/field[@name='list_price']" position="attributes">
                <attribute name="attrs">{'readonly' : [('allowed_modify_sale_price', '=', False)]}</attribute>
            </xpath>
        </field>
    </record>

    <!-- stock.picking inherit form view -->
    <record id="stock_picking_form_view_inherited" model="ir.ui.view">
        <field name="name">stock.picking.inherit.view.form</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='button_validate']" position="replace">
                <field name='donot_allow_validate_incoming_shipment' invisible="1"/>
                <button name="button_validate" attrs="{'invisible': ['|', '|', ('state', 'in', ('waiting','confirmed')), ('show_validate', '=', False), ('donot_allow_validate_incoming_shipment', '=', False)]}" string="Validate" type="object" class="oe_highlight" groups="stock.group_stock_user"/>
            </xpath>
        </field>
    </record>

    <!-- product template inherit form view -->
    <record id="product_template_form_view_extended" model="ir.ui.view">
        <field name="name">product.template.inherit.view.form</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="stock.product_template_form_view_procurement_button"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='action_update_quantity_on_hand']" position="before">
                <field name="allowed_inv_operations" invisible="1"/>
            </xpath>
            <xpath expr="//button[@name='action_update_quantity_on_hand']" position="attributes">
                <attribute name="groups">access_rights.group_allow_inventory_operations</attribute>
            </xpath>
            <xpath expr="//div[@name='button_box']/button[@name='action_open_quants']" position="attributes">
                <attribute name="disabled">1</attribute>
            </xpath>
        </field>
    </record>

    <record id="product_template_new_form_view_extended" model="ir.ui.view">
        <field name="name">product.template.inherit.new.view.form</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="stock.product_template_form_view_procurement_button"/>
        <field name="groups_id" eval="[(4, ref('access_rights.group_allow_inventory_operations'))]"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@name='button_box']/button[@name='action_open_quants']" position="replace">
                <button type="object"
                    name="action_open_quants"
                    attrs="{'invisible':[('type', '!=', 'product')]}"
                    class="oe_stat_button" icon="fa-cubes">
                    <div class="o_field_widget o_stat_info">
                        <span class="o_stat_value" widget="statinfo">
                            <field name="qty_available" widget="statinfo" nolabel="1" class="mr4"/>
                            <field name="uom_name"/>
                        </span>
                        <span class="o_stat_text">On Hand</span>
                    </div>
                </button>
            </xpath>
        </field>
    </record>
    <menuitem action="stock.action_inventory_form" id="stock.menu_action_inventory_form" parent="stock.menu_stock_warehouse_mgmt" sequence="30" groups="access_rights.group_allow_inventory_operations"/>
</odoo>